<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Today's pay, tomorrow's harvest"><meta name="keywords" content=""><meta name="author" content="liweipeng"><meta name="copyright" content="liweipeng"><title>Today's pay, tomorrow's harvest | 李伟朋@博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '4.2.1'
} </script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="李伟朋@博客" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">liweipeng</div><div class="author-info__description text-center">Today's pay, tomorrow's harvest</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">24</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">12</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">15</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">李伟朋@博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"></span></div><div id="site-info"><div id="site-title">李伟朋@博客</div><div id="site-sub-title">Today's pay, tomorrow's harvest</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/15/MongoDB%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%EF%BC%88%E5%9B%9B%EF%BC%89/">MongoDB 数据库优化操作</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/MongoDB/">MongoDB</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><div class="content"><h2 id="分片相关"><a href="#分片相关" class="headerlink" title="分片相关"></a>分片相关</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">db.runCommand(&#123; isdbgrid : 1&#125;);      # 判断是否Shard集群</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 列出所有分片信息</span></span><br><span class="line">use admin;</span><br><span class="line">db.runCommand(&#123; listshards : 1&#125;);</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 列出开启分片的数据库</span></span><br><span class="line">use config;</span><br><span class="line">db.databases.find(&#123;"partitioned":true&#125;);</span><br><span class="line">db.databases.find();                # 列出所有数据库分片情况</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看分片的片键</span></span><br><span class="line">use config;</span><br><span class="line">db.collections.find();</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除片键</span></span><br><span class="line">use config;</span><br><span class="line">db.collections.remove(&#123;"_id":"testdb.t_user"&#125;);</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 刷新mongos的缓存</span></span><br><span class="line">use admin;</span><br><span class="line">db.adminCommand(&#123;"flushRouterConfig":1&#125;);</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除分片节点</span></span><br><span class="line">db.runCommand(&#123;removeShard:"shard-2"&#125;);</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 其他</span></span><br><span class="line">db.getPrevError();       # 查询之前的错误信息</span><br><span class="line">db.resetError();         # 清除错误记录</span><br></pre></td></tr></table></figure>

<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建索引</span></span><br><span class="line">db.&lt;foo&gt;.ensureIndex(&#123;name: 1&#125;);</span><br><span class="line">db.&lt;foo&gt;.ensureIndex(&#123;name: 1, ts: -1&#125;);</span><br><span class="line"></span><br><span class="line">db.&lt;foo&gt;.getIndexes();         # 查询当前聚集集合所有索引</span><br><span class="line">db.&lt;foo&gt;.totalIndexSize();     # 查看总索引记录大小</span><br><span class="line">db.users.reIndex();            # 读取当前集合的所有index信息</span><br><span class="line">db.users.dropIndex("name_1");  # 删除指定索引</span><br><span class="line">db.users.dropIndexes();        # 删除所有索引索引</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/14/MongoDB%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%EF%BC%88%E4%B8%89%EF%BC%89/">MongoDB用户相关操作</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/MongoDB/">MongoDB</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><div class="content"><h2 id="用户相关操作"><a href="#用户相关操作" class="headerlink" title="用户相关操作"></a>用户相关操作</h2><p>如果系统已经启动权限验证，必须使用拥有权限的账户登录操作。mongodb角色权限文档：<a href="https://docs.mongodb.com/v3.6/reference/built-in-roles/index.html" target="_blank" rel="noopener">https://docs.mongodb.com/v3.6/reference/built-in-roles/index.html</a></p>
<p>创建一个超级用户角色：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use admin;</span><br><span class="line">db.createUser(</span><br><span class="line">  &#123;</span><br><span class="line">    user: &quot;admin&quot;,</span><br><span class="line">    pwd: &quot;pwd123&quot;,</span><br><span class="line">    roles: [ &quot;root&quot; ]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>root角色为所有资源提供完全权限，相当于MySQL里的 root 账户。</p>
<p>在 testdb 数据库中创建一个 testuser 账户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use testdb;</span><br><span class="line">db.createUser(</span><br><span class="line">  &#123;</span><br><span class="line">    user: &quot;testuser&quot;,</span><br><span class="line">    pwd: &quot;123456&quot;,</span><br><span class="line">    roles: [ &#123; role: &quot;dbOwner&quot;, db: &quot;testdb&quot; &#125; ]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>dbOwner</code>代表数据库所有者，可以对数据库执行任何管理操作，包含<code>readWrite</code>、<code>dbAdmin</code>和<code>userAdmin</code>角色的权限。</p>
<p>在 admin 库中创建一个具有多个权限的账户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">user admin;</span><br><span class="line">db.createUser(</span><br><span class="line">  &#123; user: &quot;admin&quot;,</span><br><span class="line">    pwd: &quot;123456&quot;,</span><br><span class="line">    roles: [ &quot;userAdminAnyDatabase&quot;, &quot;dbAdminAnyDatabase&quot;, &quot;readWriteAnyDatabase&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line">show users;            # 显示当前库所有用户</span><br><span class="line">db.getUser(&#39;admin&#39;);   # 查看用户详情</span><br><span class="line">db.dropUser(&quot;admin&quot;);  # 删除用户</span><br><span class="line">db.logout();           # 退出当前登录</span><br><span class="line"></span><br><span class="line"># 修改用户密码</span><br><span class="line">use testdb;</span><br><span class="line">db.updateUser(&quot;testuser&quot;, &#123;pwd: &quot;123456789&quot;&#125;);</span><br><span class="line">db.changeUserPassword(&quot;testuser&quot;, &quot;123456789&quot;);</span><br><span class="line"></span><br><span class="line"># 修改用户角色</span><br><span class="line">use testdb;</span><br><span class="line">db.updateUser(</span><br><span class="line">  &quot;&lt;username&gt;&quot;,</span><br><span class="line">  roles : [&#123; role: &quot;&quot;, db: &quot;&quot; &#125;]</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>用户相关操作文档：<a href="https://docs.mongodb.com/manual/reference/method/js-user-management/" target="_blank" rel="noopener">https://docs.mongodb.com/manual/reference/method/js-user-management/</a></p>
<h2 id="连接数据库身份验证"><a href="#连接数据库身份验证" class="headerlink" title="连接数据库身份验证"></a>连接数据库身份验证</h2><p>连接后身份验证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mongo --port 20000</span><br><span class="line">use admin;</span><br><span class="line">db.auth(&quot;testuser&quot;, &quot;123456&quot;);</span><br></pre></td></tr></table></figure>

<p>连接时身份验证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo --port 27017 -u &quot;root&quot; -p &quot;123456&quot; --authenticationDatabase &quot;admin&quot;</span><br></pre></td></tr></table></figure>

<p>连接时身份验证，并进入指定库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mongo --port 20000 -u &quot;root&quot; -p &quot;123456&quot; --authenticationDatabase &quot;admin&quot;</span><br><span class="line">mongo --port 20000 -u &quot;testuser&quot; -p &quot;123456&quot; --authenticationDatabase &quot;admin&quot; testdb</span><br></pre></td></tr></table></figure>

<p>代码、客户端连接方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mongodb:&#x2F;&#x2F;testuser:123456789@192.168.0.3:20000,192.168.0.4:20000,192.168.0.5:20000&#x2F;testdb</span><br><span class="line">mongodb:&#x2F;&#x2F;root:pwd123@192.168.0.3:20000,192.168.0.4:20000,192.168.0.5:20000&#x2F;admin</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/13/MongoDB%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%EF%BC%88%E4%BA%8C%EF%BC%89/">MongoDB 增删改查 集合数据</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-13</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/MongoDB/">MongoDB</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><div class="content"><h3 id="增加"><a href="#增加" class="headerlink" title="增加"></a>增加</h3><p>在user集合添加数据，添加的数据的数据列，没有固定，根据添加的数据为准：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.users.save(&#123;name: <span class="string">'zhangsan'</span>, age: <span class="number">25</span>, sex: true&#125;);</span><br><span class="line"><span class="keyword">for</span>(var i=<span class="number">1</span>;i&lt;=<span class="number">20000</span>;i++) db.users.save(&#123;id:i, testkey:<span class="string">"test_val_"</span>+i&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h3><p>语法：<code>db.collection.update(criteria, objNew, upsert, multi )</code></p>
<ul>
<li><code>criteria</code>查询条件，类似 sql <code>update</code>查询内<code>where</code>后面的。</li>
<li><code>objNew</code>update 的对象和一些更新的操作符（如<code>$,$inc</code>…）等，可以理解为sql <code>update</code>查询内<code>set</code>后面的。</li>
<li><code>upsert</code>如果不存在update的记录，是否插入<code>objNew，true</code>为插入，默认是<code>false</code>，不插入。</li>
<li><code>multi</code>默认是<code>false</code>，只更新找到的第一条记录，如果这个参数为<code>true</code>，就把按条件查出来多条记录全部更新。</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.users.update(&#123;age: <span class="number">25</span>&#125;, &#123;<span class="variable">$set:</span> &#123;name: <span class="string">'changeName'</span>&#125;&#125;, false, true);</span><br><span class="line"><span class="comment"># 等于SQL：update users set name = 'changeName' where age = 25;</span></span><br><span class="line"></span><br><span class="line">db.users.update(&#123;name: <span class="string">'Lisi'</span>&#125;, &#123;<span class="variable">$inc:</span> &#123;age: <span class="number">50</span>&#125;&#125;, false, true);</span><br><span class="line"><span class="comment"># 等于SQL：update users set age = age + 50 where name = 'Lisi';</span></span><br><span class="line"></span><br><span class="line">db.users.update(&#123;name: <span class="string">'Lisi'</span>&#125;, &#123;<span class="variable">$inc:</span> &#123;age: <span class="number">50</span>&#125;, <span class="variable">$set:</span> &#123;name: <span class="string">'hoho'</span>&#125;&#125;, false, true);</span><br><span class="line"><span class="comment"># 等于SQL：update users set age = age + 50, name = 'hoho' where name = 'Lisi';</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新 users 表里面 login == lxk 修改  email 字段为后面的那个值，false 表示如果不存在就不插入新数据；true 代表查询修改所有符合条件的数据：</span></span><br><span class="line">db.getCollection(<span class="string">'users'</span>).update(&#123;<span class="string">"login"</span> : <span class="string">"lxk"</span>&#125;, &#123;<span class="variable">$set:</span> &#123;<span class="string">"email"</span>: <span class="string">'sk@123.com'</span>&#125;&#125;, false, true);</span><br></pre></td></tr></table></figure>

<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p>这里``表示一个集合（相当于MySQL的表）。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询所有记录，默认每页20条记录，输入 it 查看下一页：</span></span><br><span class="line">db.&lt;foo&gt;.find();</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 去掉集合中 name 列的重复数据</span></span><br><span class="line">db.&lt;foo&gt;.distinct(<span class="string">"name"</span>);</span><br><span class="line"><span class="comment"># 等于SQL：select distict name from &lt;foo&gt;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 id = 22 的记录</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;<span class="string">"id"</span>: <span class="number">22</span>&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where id = 22;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 age &gt; 22 的记录</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$gt:</span> <span class="number">22</span>&#125;&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where age &gt; 22;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 age &lt; 22 的记录</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$lt:</span> <span class="number">22</span>&#125;&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where age &lt; 22;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 age &gt;= 25 的记录</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$gte:</span> <span class="number">25</span>&#125;&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where age &gt;= 25;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 age &lt;= 25 的记录</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$lte:</span> <span class="number">25</span>&#125;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 age &gt;= 23 并且 age &lt;= 26</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$gte:</span> <span class="number">23</span>, <span class="variable">$lte:</span> <span class="number">26</span>&#125;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 name 中包含 mongo 的数据</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;name: /mongo/&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where name like '%mongo%';</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 name 中以 mongo 开头的</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;name: /^mongo/&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where name like 'mongo%';</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查询指定列 name、age 数据</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;&#125;, &#123;name: <span class="number">1</span>, age: <span class="number">1</span>&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select name, age from &lt;foo&gt;;</span></span><br><span class="line"><span class="comment"># 这里 1 可以写成 true，如果写成 false 表示排除此列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询指定列 name、age 数据, age &gt; 25</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$gt:</span> <span class="number">25</span>&#125;&#125;, &#123;name: <span class="number">1</span>, age: <span class="number">1</span>&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select name, age from &lt;foo&gt; where age &gt; 25;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照年龄排序</span></span><br><span class="line">db.&lt;foo&gt;.find().sort(&#123;age: <span class="number">1</span>&#125;);    <span class="comment"># 升序</span></span><br><span class="line">db.&lt;foo&gt;.find().sort(&#123;age: <span class="literal">-1</span>&#125;);   <span class="comment"># 降序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 name = zhangsan, age = 22 的数据</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;name: <span class="string">'zhangsan'</span>, age: <span class="number">22</span>&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where name = 'zhangsan' and age = '22';</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询前5条数据</span></span><br><span class="line">db.&lt;foo&gt;.find().limit(<span class="number">5</span>);</span><br><span class="line"><span class="comment"># 等于SQL：select top 5 * from &lt;foo&gt;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询10条以后的数据</span></span><br><span class="line">db.&lt;foo&gt;.find().skip(<span class="number">10</span>);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where id not in (select top 10 * from &lt;foo&gt;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询在 5-10 之间的数据</span></span><br><span class="line">db.&lt;foo&gt;.find().limit(<span class="number">10</span>).skip(<span class="number">5</span>);</span><br><span class="line"><span class="comment"># 可用于分页，limit 是 pageSize，skip 是第几页 pageSize</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># or查询</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;<span class="variable">$or:</span> [&#123;<span class="type">age</span>: <span class="number">22</span>&#125;, &#123;<span class="type">age</span>: <span class="number">25</span>&#125;]&#125;);</span><br><span class="line"><span class="comment"># 等于SQL：select * from &lt;foo&gt; where age = 22 or age = 25;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询第一条数据</span></span><br><span class="line">db.&lt;foo&gt;.findOne();</span><br><span class="line">db.&lt;foo&gt;.find().limit(<span class="number">1</span>);</span><br><span class="line"><span class="comment"># 等于SQL：selecttop 1 * from &lt;foo&gt;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询某个结果集的记录条数</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;age: &#123;<span class="variable">$gte:</span> <span class="number">25</span>&#125;&#125;).count();</span><br><span class="line"><span class="comment"># 等于SQL：select count(*) from &lt;foo&gt; where age &gt;= 20;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果要返回限制之后的记录数量，要使用 count(true) 或 count(非0) </span></span><br><span class="line">db.users.find().skip(<span class="number">10</span>).limit(<span class="number">5</span>).count(true);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照某列进行排序</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;sex: &#123;<span class="variable">$exists:</span> true&#125;&#125;).count();</span><br><span class="line"><span class="comment"># 等于SQL：select count(sex) from &lt;foo&gt;;</span></span><br></pre></td></tr></table></figure>

<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.users.remove(&#123;age: <span class="number">132</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>查询修改删除：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.users.findAndModify(&#123;</span><br><span class="line">    query: &#123;age: &#123;<span class="variable">$gte:</span> <span class="number">25</span>&#125;&#125;,</span><br><span class="line">    sort: &#123;age: <span class="literal">-1</span>&#125;,</span><br><span class="line">    update: &#123;<span class="variable">$set:</span> &#123;name: <span class="string">'a2'</span>&#125;, <span class="variable">$inc:</span> &#123;age: <span class="number">2</span>&#125;&#125;,</span><br><span class="line">    remove: true</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">db.runCommand(&#123; findandmodify : <span class="string">"users"</span>,</span><br><span class="line">    query: &#123;age: &#123;<span class="variable">$gte:</span> <span class="number">25</span>&#125;&#125;,</span><br><span class="line">    sort: &#123;age: <span class="literal">-1</span>&#125;,</span><br><span class="line">    update: &#123;<span class="variable">$set:</span> &#123;name: <span class="string">'a2'</span>&#125;, <span class="variable">$inc:</span> &#123;age: <span class="number">2</span>&#125;&#125;,</span><br><span class="line">    remove: true</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/12/MongoDB%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%EF%BC%88%E4%B8%80%EF%BC%89/">MongoDB 数据库基本操作命令</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-12</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E5%90%8E%E7%AB%AF/MongoDB/">MongoDB</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><div class="content"><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show dbs;          <span class="comment"># 查看数据库列表</span></span><br><span class="line">show collections;  <span class="comment"># 查看当前数据库中的集合（理解为MySQL中的表）</span></span><br><span class="line">show tables;       <span class="comment"># 同上</span></span><br><span class="line">show users;        <span class="comment"># 查看用户</span></span><br></pre></td></tr></table></figure>

<h2 id="数据库相关操作"><a href="#数据库相关操作" class="headerlink" title="数据库相关操作"></a>数据库相关操作</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use &lt;dbName&gt;;           <span class="comment"># 进入到 &lt;dbName&gt; 库，不存在则创建 </span></span><br><span class="line">db;                     <span class="comment"># 查看当前所在库名</span></span><br><span class="line">db.help();              <span class="comment"># 数据库命令帮助</span></span><br><span class="line">db.dropDatabase();      <span class="comment"># 删除当前所在的库</span></span><br><span class="line">db.stats();             <span class="comment"># 当前库状态</span></span><br><span class="line">db.repairDatabase();    <span class="comment"># 修复当前数据库</span></span><br><span class="line">db.getMongo();          <span class="comment"># 查看当前db的链接机器地址</span></span><br><span class="line"></span><br><span class="line">db.printCollectionStats();                      <span class="comment"># 显示当前db所有聚集索引的状态</span></span><br><span class="line">db.cloneDatabase(<span class="string">"10.0.0.1"</span>);                   <span class="comment"># 克隆 10.0.0.1 的库到本机</span></span><br><span class="line">db.copyDatabase(<span class="string">"db1"</span>, <span class="string">"db2"</span>, <span class="string">"127.0.0.1"</span>);     <span class="comment"># 将本机 db1 库复制到 bd2 库中</span></span><br></pre></td></tr></table></figure>

<h2 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h2><p>集合操作需先进入库中</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">db.&lt;foo&gt;.help();                        <span class="comment"># 显示 &lt;foo&gt; 集合操作命令</span></span><br><span class="line">db.&lt;foo&gt;.find();                        <span class="comment"># 对于当前数据库中的 &lt;foo&gt; 集合进行数据查找</span></span><br><span class="line">db.getCollection(<span class="string">"&lt;foo&gt;"</span>).find(&#123;&#125;);     <span class="comment"># 同上</span></span><br><span class="line">db.&lt;foo&gt;.find(&#123;id:<span class="number">10</span>&#125;);                 <span class="comment"># 在 &lt;foo&gt; 集合中查找，条件是 id 等于 10</span></span><br><span class="line">db.createCollection(<span class="string">'user'</span>);            <span class="comment"># 创建一个 user 集合</span></span><br><span class="line"></span><br><span class="line">db.&lt;foo&gt;.count();          <span class="comment"># 查询当前集合的数据条数</span></span><br><span class="line">db.&lt;foo&gt;.dataSize();       <span class="comment"># 查看数据空间大小</span></span><br><span class="line">db.&lt;foo&gt;.getDB();          <span class="comment"># 查看集合所在的库</span></span><br><span class="line">db.&lt;foo&gt;.stats();          <span class="comment"># 查看集合的状态</span></span><br><span class="line">db.&lt;foo&gt;.totalSize();      <span class="comment"># 集合总大小 </span></span><br><span class="line">db.&lt;foo&gt;.storageSize();    <span class="comment"># 集合储存空间大小</span></span><br><span class="line">db.&lt;foo&gt;.drop();           <span class="comment"># 删除集合</span></span><br><span class="line"></span><br><span class="line">db.&lt;foo&gt;.getShardVersion();                  <span class="comment"># Shard版本信息</span></span><br><span class="line">db.&lt;foo<span class="literal">-1</span>&gt;.renameCollection(<span class="string">"&lt;foo-2&gt;"</span>);      <span class="comment"># 聚集集合重命名</span></span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/11/vue3.0%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E5%92%8C%E9%85%8D%E7%BD%AE/">vue-cli3项目搭建配置以及性能优化</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/Vue%E5%AD%A6%E4%B9%A0/">Vue学习</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/vue/">vue</a></span><div class="content"><p><strong>项目初始化</strong></p>
<p>注意：安装前请确保有安装node.js，并且node&gt;=8.9</p>
<p>全局安装vue　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue&#x2F;cli</span><br></pre></td></tr></table></figure>

<p>如果之前安装了vue旧版本，查看vue –version</p>
<p>创建项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create vue-cli3-init(项目名)</span><br></pre></td></tr></table></figure>

<p>注：名称不能采用驼峰</p>
<p>vue-cli3也可以采用UI面板进行配置，相对比较方便，目前先写命令行创建，后续再加上面板创建。</p>
<p>选择配置，默认配置还是手动，这里我选择手动Manually，继续回车会让你选择你想要功能。 （不用用git窗口，选择不了选项，可以使用<strong>上下方向</strong>来切换选项）</p>
<p>此处有两个选择：</p>
<ul>
<li>default (babel, eslint) 默认套餐，提供 babel 和 eslint 支持。</li>
<li>Manually select features 自己去选择需要的功能，提供更多的特性选择。比如如果想要支持 TypeScript，就应该选择这一项。</li>
</ul>
<p><img src="C:%5CUsers%5CLIZARD%5CDesktop%5Cmyblog%5Csource%5Cimages%5CSnipaste_2020-07-10_16-50-12.png" alt=""></p>
<p>回车后可进行选择，8个功能特性，可以多选： 使用方向键在特性选项之间切换，使用空格键选中当前特性，使用 a 键切换选择所有，使用 i 键翻转选项。我的选择如下，请根据自己需要进行选择。</p>
<p>对于每一项的功能，此处做个简单描述：</p>
<ul>
<li><strong>TypeScript</strong> 支持使用 TypeScript 书写源码。</li>
<li><strong>Progressive Web App (PWA) Support PWA</strong> 支持。</li>
<li><strong>Router</strong> 支持 vue-router 。</li>
<li><strong>Vuex</strong> 支持 vuex 。</li>
<li><strong>CSS Pre-processors</strong> 支持 CSS 预处理器。</li>
<li><strong>Linter / Formatter</strong> 支持代码风格检查和格式化。</li>
<li><strong>Unit Testing</strong> 支持单元测试。</li>
<li><strong>E2E Testing</strong> 支持 E2E 测试。</li>
</ul>
<p><img src="C:%5CUsers%5CLIZARD%5CDesktop%5Cmyblog%5Csource%5Cimages%5CSnipaste_2020-07-10_16-50-33.png" alt=""></p>
<p>是否选择history模式，根据自己需要选择。</p>
<p><img src="C:%5CUsers%5CLIZARD%5CDesktop%5Cmyblog%5Csource%5Cimages%5CSnipaste_2020-07-10_16-50-43.png" alt=""></p>
<p>是否选择预语言，根据自己需要选择。</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aec9f0fb7278d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p> 是否ESlint输出，根据自己需要选择。</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aeca9b658e703?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>是否保存时或者提交时是进行ESlint校验，根据自己需要选择。</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aecb8a5e09850?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>选择把配置文件放在外面，选择 In dedicated config files</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aeccfdbe1eef6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>要不要把当前的这一系列选项配置保存起来，方便下一次创建项目时复用。</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aed0638141ad7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>项目初始化完成，进入项目:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd vue-cli3-init</span><br><span class="line">依赖安装完成之后启动项目：</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2019/3/24/169aedb8b6d4a07c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p><strong>修改目录结构</strong></p>
<p>用编辑器打开后可以看到目录结构。相对于vue-cli2精简了很多，减少了对webpack的配置。 </p>
<p><img src="https://upload-images.jianshu.io/upload_images/14483412-05dadc2fc3b24a64" alt="img"></p>
<ul>
<li><p>node_modules 文件夹 项目依赖(对webpack进行了封装)</p>
</li>
<li><p>public 文件夹</p>
<p>1.favicon.ico 是 网站图标</p>
<p>2.index.html 页面入口文件</p>
</li>
<li><p>src 文件夹</p>
<p>main.js 入口js</p>
<p>assets 存放静态文件</p>
<p>components 存放公用组件</p>
<p>App.vue 入口vue文件</p>
</li>
<li><p>.eslintrc.js 配置</p>
</li>
<li><p>.gitignore 指定文件无需提交到git上</p>
</li>
<li><p>balel.config.js 使用一些预设</p>
</li>
<li><p>package.json 项目描述及依赖</p>
</li>
<li><p>package-lock.json 版本管理使用的文件</p>
</li>
</ul>
<p>由于现在的目录结构不利于后期的开发，现在我们增加部分文件，待后续可以进行功能扩展。在src文件下：新建api文件夹，config文件夹,router文件夹，utils文件夹，views文件夹，store文件夹。并在其文件下建子目录，详细请参考目录截图：</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1452252/201912/1452252-20191209095942383-537773899.png" alt="img"> </p>
<p><strong>多环境运行</strong></p>
<p>由于我们的项目需要在不同环境下进行运行(开发，生产，测试等)，这避免我们需要多次的去切换请求的地址以及相关的配置，vue-cli2是可以直接在config文件中进行配置的，但是vue-cli3已经简化了，官方文档也有进行配置的说明，实现具体有以下2种方法，我比较偏向第二种。</p>
<p><em>第一种实现方法</em></p>
<p>1.在根目录新建2个文件，分别为<code>.env.development</code>，<code>.env.production</code>，<code>.env.test</code>。注意文件是只有后缀的。</p>
<p><code>.env.development</code> 模式用于serve，开发环境，就是开始环境的时候会引用这个文件里面的配置</p>
<p><code>.env.production</code>模式用于build，线上环境。</p>
<p><code>.env.test</code> 测试环境</p>
<p>2.分别在文件内写上：</p>
<p>开发环境：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;.env.development </span><br><span class="line">VUE_APP_BASE_API &#x3D; &#39;需要请求API&#39;</span><br></pre></td></tr></table></figure>

<p>线上环境：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;.env.production</span><br><span class="line">VUE_APP_BASE_API &#x3D; &#39;需要请求API&#39;</span><br></pre></td></tr></table></figure>

<p>测试环境：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;.env.test</span><br><span class="line">VUE_APP_BASE_API &#x3D; &#39;需要请求API&#39;</span><br></pre></td></tr></table></figure>

<p>当需要用到该变量是可以用<code>process.env.VUE_APP_BASE_API</code>进行取值。</p>
<p>3.更改package.json文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;dev&quot;: &quot;vue-cli-service serve&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;vue-cli-service serve --mode test&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;vue-cli-service build&quot;,</span><br><span class="line">    &quot;build:test&quot;: &quot;vue-cli-service build --mode test&quot;,</span><br><span class="line">    &quot;lint&quot;: &quot;vue-cli-service lint&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p><em>第二种实现方式</em></p>
<p>1.在config文件新建index.js文件，根据全局的环境变量来进行判断，并进行输出。代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 一些全局的config配置</span><br><span class="line">const modeUrlObj &#x3D; &#123;</span><br><span class="line">  &#x2F;&#x2F; 生产环境</span><br><span class="line">  &#39;production&#39;: &#123;</span><br><span class="line">    baseURL: &#39;http:&#x2F;&#x2F;xxx:9091&#x2F;pro&#x2F;&#39;,</span><br><span class="line">    authBaseURL: &#39;&#39;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x2F;&#x2F; 开发环境</span><br><span class="line">  &#39;development&#39;: &#123;</span><br><span class="line">    baseURL: &#39;http:&#x2F;&#x2F;xxxx:9091&#x2F;dev&#x2F;&#39;,</span><br><span class="line">    authBaseURL: &#39;&#39;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x2F;&#x2F; 测试环境</span><br><span class="line">  &#39;test&#39;: &#123;</span><br><span class="line">    baseURL: &#39;http:&#x2F;&#x2F;xxxx:9091&#x2F;test&#x2F;&#39;,</span><br><span class="line">    authBaseURL: &#39;&#39;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default modeUrlObj[process.env.NODE_ENV]</span><br></pre></td></tr></table></figure>

<p>2.更改package.json文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;dev&quot;: &quot;vue-cli-service serve&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;vue-cli-service serve --mode test&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;vue-cli-service build&quot;,</span><br><span class="line">    &quot;build:test&quot;: &quot;vue-cli-service build --mode test&quot;,</span><br><span class="line">    &quot;lint&quot;: &quot;vue-cli-service lint&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>3.引用的方法可以参照如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import config from &#39;..&#x2F;config&#x2F;index&#39; &#x2F;&#x2F; 路径配置</span><br><span class="line">config.baseURL  &#x2F;&#x2F; 对应环境api</span><br></pre></td></tr></table></figure>

<p>4.运行命令行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm run dev &#x2F;&#x2F; 开发环境</span><br><span class="line">npm run test &#x2F;&#x2F; 测试环境</span><br><span class="line">npm run build &#x2F;&#x2F; 正式环境打包</span><br><span class="line">npm run build:test &#x2F;&#x2F; 测试环境打包</span><br></pre></td></tr></table></figure>

<p><strong>axios封装</strong></p>
<p>在vue项目中，和后台交互获取数据这块，我们通常使用的是axios库，它是基于promise的http库，可运行在浏览器端和node.js中。他有很多优秀的特性，例如拦截请求和响应、取消请求、转换json、客户端防御XSRF等。所以我们的尤大大也是果断放弃了对其官方库vue-resource的维护，直接推荐我们使用axios库。如果还对axios不了解的，可以移步<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.kancloud.cn%2Fyunye%2Faxios%2F234845" target="_blank" rel="noopener">axios文档</a>。</p>
<p>安装依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios --save; &#x2F;&#x2F; 安装axios</span><br></pre></td></tr></table></figure>

<p>配置axios</p>
<p>在uitls文件下新增request.js文件，在这里我们对axios进行初始化后，暴露给需要引用的文件，方便开发。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#39;axios&#39;</span><br><span class="line">import config from &#39;..&#x2F;config&#x2F;index&#39; &#x2F;&#x2F; 路径配置</span><br></pre></td></tr></table></figure>

<p>创建axios实例，并进行配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 创建axios 实例</span><br><span class="line">const service &#x3D; axios.create(&#123;</span><br><span class="line">    baseURL: config.baseURL, &#x2F;&#x2F; api的base_url</span><br><span class="line">    timeout: 10000 &#x2F;&#x2F; 请求超时时间</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>利用axios的请求拦截和响应拦截可以对登录和权限方面进行控制，具体需求可以自己进行配置。完整代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#39;axios&#39;</span><br><span class="line">import config from &#39;..&#x2F;config&#x2F;index&#39; &#x2F;&#x2F; 路径配置</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 创建axios 实例</span><br><span class="line">const service &#x3D; axios.create(&#123;</span><br><span class="line">    baseURL: config.baseURL, &#x2F;&#x2F; api的base_url</span><br><span class="line">    timeout: 10000 &#x2F;&#x2F; 请求超时时间</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; request 拦截器</span><br><span class="line">service.interceptors.request.use(</span><br><span class="line">    config &#x3D;&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F; 这里可以自定义一些config 配置</span><br><span class="line"></span><br><span class="line">        return config</span><br><span class="line">    &#125;,</span><br><span class="line">    error &#x3D;&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F;  这里处理一些请求出错的情况</span><br><span class="line"></span><br><span class="line">        Promise.reject(error)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; response 拦截器</span><br><span class="line">service.interceptors.response.use(</span><br><span class="line">    response &#x3D;&gt; &#123;</span><br><span class="line">        const res &#x3D; response.data</span><br><span class="line">        &#x2F;&#x2F; 这里处理一些response 正常放回时的逻辑</span><br><span class="line"></span><br><span class="line">        return res</span><br><span class="line">    &#125;,</span><br><span class="line">    error &#x3D;&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F; 这里处理一些response 出错时的逻辑</span><br><span class="line"></span><br><span class="line">        return Promise.reject(error)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">export default service</span><br></pre></td></tr></table></figure>

<p>api请求配置</p>
<p>在api文件下新建分类的api请求文件。根据具体需要分类。主要是方便团队开发，容易归类。可以参考下面配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import request from &#39;@&#x2F;utils&#x2F;request&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  &#x2F;&#x2F; 登录</span><br><span class="line">  login (data) &#123;</span><br><span class="line">    return request(&#123;</span><br><span class="line">      url: &#39;&#x2F;login&#39;,</span><br><span class="line">      method: &#39;post&#39;,</span><br><span class="line">      data</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#x2F;&#x2F; 获取用户信息</span><br><span class="line">  getUserInfo () &#123;</span><br><span class="line">    return request(&#123;</span><br><span class="line">      url: &#39;&#x2F;userinfo&#39;,</span><br><span class="line">      method: &#39;get&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>业务中需要进行请求可以用import后，进行传参即可。 </p>
<h3 id="模块化vuex"><a href="#模块化vuex" class="headerlink" title="模块化vuex"></a><strong>模块化vuex</strong></h3><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>
<p>如果对vuex还不大了解的可以自行<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fvuex.vuejs.org%2Fzh%2Fguide%2F" target="_blank" rel="noopener">阅读vuex官方文档</a>。</p>
<p>安装vuex</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex -S</span><br></pre></td></tr></table></figure>

<p>新建目录</p>
<p>modules文件主要用法存放分类的文件，可以进行区分，getters文件是对state进行处理，index.js主要进行一些引入，初始化操作。 </p>
<p><img src="https://upload-images.jianshu.io/upload_images/14483412-26d1cace7784776d" alt="img"></p>
<p>书写vuex配置</p>
<p>index.js文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Vuex from &#39;vuex&#39;</span><br><span class="line">import user from &#39;.&#x2F;modules&#x2F;user&#39; &#x2F;&#x2F; 引入各个模块的代码</span><br><span class="line">import getters from &#39;.&#x2F;getters&#39;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line">const store &#x3D; new Vuex.Store(&#123;</span><br><span class="line">    modules: &#123;</span><br><span class="line">        user</span><br><span class="line">    &#125;,</span><br><span class="line">    getters</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default store</span><br></pre></td></tr></table></figure>

<p>getter.js文件</p>
<p>getter中的配置可根据需求进行增加或者删除，下面是示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const getters &#x3D; &#123;</span><br><span class="line">  requestLoading: state &#x3D;&gt; state.app.requestLoading,</span><br><span class="line">  size: state &#x3D;&gt; state.app.size,</span><br><span class="line">  token: state &#x3D;&gt; state.user.token,</span><br><span class="line">  avatar: state &#x3D;&gt; state.user.avatar,</span><br><span class="line">  name: state &#x3D;&gt; state.user.name,</span><br><span class="line">  roles: state &#x3D;&gt; state.user.roles</span><br><span class="line">&#125;</span><br><span class="line">export default getters</span><br></pre></td></tr></table></figure>

<p>moduels/user.js文件</p>
<p>该文件为与业务相关，可以跟据具体参见进行增加和删除命名。每个文件的基本配置和用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import &#123; getToken, setToken &#125; from &#39;@&#x2F;utils&#x2F;auth&#39;</span><br><span class="line">import api from &#39;@&#x2F;api&#x2F;user&#39;</span><br><span class="line"></span><br><span class="line">const user &#x3D; &#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    token: getToken(),</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  mutations: &#123;</span><br><span class="line">    SET_TOKEN: (state, token) &#x3D;&gt; &#123;</span><br><span class="line">      state.token &#x3D; token</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  actions: &#123;</span><br><span class="line">    &#x2F;&#x2F; 登录</span><br><span class="line">    Login (&#123; commit &#125;, userInfo) &#123;</span><br><span class="line">      return new Promise((resolve, reject) &#x3D;&gt; &#123;</span><br><span class="line">        api.login(userInfo).then(res &#x3D;&gt; &#123;</span><br><span class="line">          if (res.code &#x3D;&#x3D;&#x3D; 200) &#123;</span><br><span class="line">            setToken(res.data)</span><br><span class="line">            commit(&#39;SET_TOKEN&#39;, res.data)</span><br><span class="line">          &#125;</span><br><span class="line">          resolve()</span><br><span class="line">        &#125;).catch(err &#x3D;&gt; &#123;</span><br><span class="line">          reject(err)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default user</span><br></pre></td></tr></table></figure>

<h3 id="全局样式引用"><a href="#全局样式引用" class="headerlink" title="全局样式引用"></a><strong>全局样式引用</strong></h3><p>在项目开发过程中，我们经常需要全局样式引用，例如主题色等，如果每次去写的化会变得很麻烦。因为我们应该了sass预语言编译，所以可以大胆的应用其特性。例如变量，函数，混入等。但是我们需要在项目中进行全局的配置才能有效果。不用在每一个页面都进行引入样式，就能直接引用。</p>
<p>新建目录</p>
<p>在assets下新建如下文件，具体的代码自行进行配置</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* <span class="selector-tag">common</span><span class="selector-class">.scss</span> 主要存放公共的样式</span><br><span class="line">* <span class="selector-tag">mixin</span><span class="selector-class">.scss</span> 存放混入样式</span><br><span class="line">* <span class="selector-tag">reset</span><span class="selector-class">.scss</span> 存放重置样式。</span><br><span class="line">* <span class="selector-tag">variable</span><span class="selector-class">.scss</span> 存放变量</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/14483412-e3a294443bed045b" alt="img"></p>
<p>全局引入</p>
<p>新建vue.config.js文件，并写上以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  css: &#123;</span><br><span class="line">    loaderOptions: &#123;</span><br><span class="line">      &#x2F;&#x2F; pass options to sass-loader</span><br><span class="line">      sass: &#123;</span><br><span class="line">        &#x2F;&#x2F; @&#x2F; is an alias to src&#x2F;</span><br><span class="line">        &#x2F;&#x2F; so this assumes you have a file named &#96;src&#x2F;variables.scss&#96;</span><br><span class="line">        data: &#96;</span><br><span class="line">               @import &quot;@&#x2F;assets&#x2F;css&#x2F;variable.scss&quot;; </span><br><span class="line">               @import &quot;@&#x2F;assets&#x2F;css&#x2F;common.scss&quot;;</span><br><span class="line">               @import &quot;@&#x2F;assets&#x2F;css&#x2F;mixin.scss&quot;;</span><br><span class="line">              &#96;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在app.vue中引入reset.scss文件，完成后，样式即可进行全局调用了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;style lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">  @import &quot;assets&#x2F;css&#x2F;reset&quot;;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="移动端适配配置"><a href="#移动端适配配置" class="headerlink" title="移动端适配配置"></a>移动端适配配置</h3><p>在本项目中主要用rem来进行页面的适配操作的，因为rem就可以随根字体大小改变而改变，从而实现了自适应的功能。但是html的字体是固定的，所以需要监听页面大小的变化，我主要用了淘宝的<code>amfe-flexible</code>来进行监听改变的。将项目中css的px转成rem单位，免去计算烦恼,我们可以用scss来进行计算或者利用<code>px2rem</code>插件来进行自动转化。因为是开发移动端，需把mate换为<br>``<br>实现方法如下：</p>
<p>安装amfe-flexible</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i amfe-flexible --save</span><br></pre></td></tr></table></figure>

<p>px转rem</p>
<p>方法一：</p>
<p>在common.scss文件中，全局引入scss函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line">  转化px为rem。$base-font-size &#x3D; 设计稿尺寸&#x2F;10</span><br><span class="line">*&#x2F;</span><br><span class="line">@function px2rem($px, $base-font-size: 37.5) &#123;</span><br><span class="line">  @return ($px&#x2F;$base-font-size)*1rem</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用方式直接： <code>width: px2rem(175);</code></p>
<p>方法二：</p>
<p>安装依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i postcss-pxtorem --save-dev</span><br></pre></td></tr></table></figure>

<p>package.json内，在postcss内添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;postcss&quot;: &#123;</span><br><span class="line">   &quot;plugins&quot;: &#123;</span><br><span class="line">     &quot;autoprefixer&quot;: &#123;&#125;,</span><br><span class="line">     &quot;postcss-pxtorem&quot;: &#123;</span><br><span class="line">       &quot;rootValue&quot;: 75, &#x2F;&#x2F; 设计稿宽度的1&#x2F;10,（JSON文件中不加注释，此行注释及下行注释均删除）</span><br><span class="line">       &quot;propList&quot;:[&quot;*&quot;] &#x2F;&#x2F; 需要做转化处理的属性，如&#96;hight&#96;、&#96;width&#96;、&#96;margin&#96;等，&#96;*&#96;表示全部</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="常用util"><a href="#常用util" class="headerlink" title="常用util"></a>常用util</h3><p>该文件主要是对一些常用的js进行封装，例如时间格式化，LocalStorage操作等，相对比较常用的方法，这个文件可以进行保存，要用到时直接复制过来用即可。下面是我封装LocalStorage的文件，可参考以下，其他自行设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import Cookies from &#39;js-cookie&#39;</span><br><span class="line"></span><br><span class="line">const TokenKey &#x3D; &#39;Authorization&#39;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 设置setLocalStorage</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function setLocalStorage (key, value) &#123;</span><br><span class="line">    window.localStorage.setItem(key, window.JSON.stringify(value))</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 获取getLocalStorage</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function getLocalStorage (key) &#123;</span><br><span class="line">    return window.JSON.parse(window.localStorage.getItem(key) || &#39;[]&#39;)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 设置setSessionStorage</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function setSessionStorage (key, value) &#123;</span><br><span class="line">    window.sessionStorage.setItem(key, window.JSON.stringify(value))</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 获取getSessionStorage</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function getSessionStorage (key) &#123;</span><br><span class="line">    return window.JSON.parse(window.sessionStorage.getItem(key) || &#39;[]&#39;)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 获取getToken</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function getToken () &#123;</span><br><span class="line">    return Cookies.get(TokenKey)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 设置setToken</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function setToken (token) &#123;</span><br><span class="line">    return Cookies.set(TokenKey, token)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;*</span><br><span class="line">* 移除removeToken</span><br><span class="line">* *&#x2F;</span><br><span class="line">export function removeToken () &#123;</span><br><span class="line">    return Cookies.remove(TokenKey)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>引入第三方UI框架(elementUI)</strong></p>
<p>\1. 打开控制台，执行vue add element命令，为项目安装element。</p>
<p>　<img src="https://img2018.cnblogs.com/blog/1328957/201907/1328957-20190702171230720-1345556025.png" alt="img"></p>
<p> 2.等待其安装完毕，在设置向导中配置引入方式和加载地区。</p>
<p>　<img src="https://img2018.cnblogs.com/blog/1328957/201907/1328957-20190702171320297-430731625.png" alt="img"></p>
<p>3.在自动安装完依赖后，可以看到相关的文件已经被创建/更新了。</p>
<p> <img src="https://img2018.cnblogs.com/blog/1328957/201907/1328957-20190702172826995-792527375.png" alt="img"></p>
<p>4.如果需要按需引入，则去到src目录下自动新建的plugins目录，编辑element.js即可，默认会导入一个Button。这么做的好处是不用把引入的ele组件写在main.js文件下，使各模块更加分离。</p>
<p>　<img src="https://img2018.cnblogs.com/blog/1328957/201907/1328957-20190702172936514-1243904540.png" alt="img"></p>
<h3 id="配置vue-config-js文件"><a href="#配置vue-config-js文件" class="headerlink" title="配置vue.config.js文件"></a>配置vue.config.js文件</h3><p>基本配置</p>
<p>1.文件目录配置别名<br>我们可以把src配置为@，如果需要就不用到根目录开始写了，直接用@/xxx/进行引用。根据自己需要进行配置，在vue.config.js文件中加入代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 配置</span><br><span class="line">chainWebpack: (config)&#x3D;&gt;&#123;</span><br><span class="line">&#x2F;&#x2F; 配置别名</span><br><span class="line">config.resolve.alias</span><br><span class="line">    .set(&#39;@&#39;, resolve(&#39;src&#39;))</span><br><span class="line">    .set(&#39;assets&#39;,resolve(&#39;src&#x2F;assets&#39;))</span><br><span class="line">    .set(&#39;components&#39;,resolve(&#39;src&#x2F;components&#39;))</span><br><span class="line">    .set(&#39;router&#39;,resolve(&#39;src&#x2F;router&#39;))</span><br><span class="line">    .set(&#39;utils&#39;,resolve(&#39;src&#x2F;utils&#39;))</span><br><span class="line">    .set(&#39;static&#39;,resolve(&#39;src&#x2F;static&#39;))</span><br><span class="line">    .set(&#39;store&#39;,resolve(&#39;src&#x2F;store&#39;))</span><br><span class="line">    .set(&#39;views&#39;,resolve(&#39;src&#x2F;views&#39;))</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>2.跨域配置<br>在前端请求过程中，如果后台没有设置跨域请求的，可以在webpack进行配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">proxy: &#123;</span><br><span class="line">  &#39;&#x2F;api&#39;: &#123;</span><br><span class="line">    target: &#39;http:&#x2F;&#x2F;127.0.0.1:8080&#39;,</span><br><span class="line">    changeOrigin: true</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.其他配置</p>
<p>具体可以参照官网的配置说明，在项目中我用到了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">assetsDir: &#39;assets&#39;,   &#x2F;&#x2F; 静态文件目录</span><br><span class="line">publicPath: &#39;.&#x2F;&#39;,    &#x2F;&#x2F; 编译后的地址，可以根据环境进行设置</span><br><span class="line">lintOnSave: true, &#x2F;&#x2F; 是否开启编译时是否不符合eslint提示</span><br></pre></td></tr></table></figure>

<p>以上的所有代码必须写在<code>module.exports</code>输出才能生效. 详细的配置可参考官网 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fcli.vuejs.org%2Fzh%2Fguide%2F%23%E8%AF%A5%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E4%BB%B6" target="_blank" rel="noopener">vue-cli3</a></p>
<h3 id="项目框架性能优化-v1-mint-ui分支"><a href="#项目框架性能优化-v1-mint-ui分支" class="headerlink" title="项目框架性能优化 (v1_mint_ui分支)"></a>项目框架性能优化 (v1_mint_ui分支)</h3><p>通过以上的基本配置，项目已经符合我们工作需要了，但是在工作过程中会发现随着项目的集成度越来越高，业务越来越多。出现了加载慢和打包文件过大的问题。导致我们页面白屏时间过长，用户体验不友好。那么如果你感兴趣的话，可以进行以下的配置，可以大大大大大的减小体积和加载速度。在master分支是没有进行优化的，如果需要看优化代码可以到另外一个分支。所以在页面引入的代码都是当前页面需要的执行代码，可以往下面几个方法进行处理。</p>
<ul>
<li>js,css代码的最小化压缩和分割</li>
<li>js,css代码公用代码提取, 按需引入(cdn加载)</li>
<li>图片文件的压缩</li>
<li>gzip的压缩</li>
<li>去除console.log</li>
</ul>
<p><strong>1.js,css代码的最小化压缩和分割</strong></p>
<p>首先，我们先对js文件进行配置以达到压缩效果，先看一下没有配置代码情况，整个app.js 的文件是2.8M（因为是初始项目），但是如果页面一多，就不只这个数了。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14483412-00f366369b1015ed" alt="img"></p>
<p>我们会通过chainWebpak来处理. 在优化前, 看下相关文件的响应代码: 看下app.js文件的返回代码:代码如下：</p>
<p><img src="https://img2018.cnblogs.com/i-beta/1452252/201912/1452252-20191209105732876-1337453018.png" alt="img"> </p>
<p>在vue.config.js文件中加入,run以下后查看app.js情况，文件会变小（由于初始项目体积小，看不出多大区别）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  chainWebpack: config &#x3D;&gt; &#123;</span><br><span class="line">    config.optimization.minimize(true);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/14483412-c99dd46b53b756e9" alt="img"></p>
<p><img src="https://img2018.cnblogs.com/i-beta/1452252/201912/1452252-20191209110939524-1694283595.png" alt="img"></p>
<p>分割代码,相应的文件中存入分割后的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    </span><br><span class="line">    chainWebpack: config &#x3D;&gt; &#123;</span><br><span class="line">        config.optimization.minimize(true);</span><br><span class="line">        config.optimization.splitChunks(&#123;</span><br><span class="line">          chunks: &#39;all&#39;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://upload-images.jianshu.io/upload_images/14483412-b13a7b83fab8c1bc" alt="img"></p>
<p>加入以上代码后，分成了2个文件，最大的只有2.7M了，这样可以分成多个进行加载，可以达到最快化，但是一定要平衡文件大小的和分割出来的文件数量的平衡, 数量多了, 请求也会变慢的, 影响性能.可以根据项目的进行设置，具体可参考官方文档的详细说明。</p>
<p><strong>2.js,css代码公用代码提取, 按需引入(<code>CDN加载</code>)</strong></p>
<p>把公用代码提取出来,然后采用使用免费的cdn资源进行加载。在项目中我们主要是引入引入不同的模块库才会导致文件较大，那么是否可以把这些文件进一步处理，答案是可以的，比如vue, vuex, vue-router, element-ui等公共资源库。利用webpack我们可以使用externals参数来配置:</p>
<p>在vue.config.js文件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    chainWebpack: config &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F; 压缩代码</span><br><span class="line">    config.optimization.minimize(true);</span><br><span class="line">    &#x2F;&#x2F; 分割代码</span><br><span class="line">    config.optimization.splitChunks(&#123;</span><br><span class="line">      chunks: &#39;all&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">    &#x2F;&#x2F; 用cdn方式引入</span><br><span class="line">    config.externals(&#123;</span><br><span class="line">      &#39;vue&#39;: &#39;Vue&#39;,</span><br><span class="line">      &#39;vuex&#39;: &#39;Vuex&#39;,</span><br><span class="line">      &#39;vue-router&#39;: &#39;VueRouter&#39;,</span><br><span class="line">      &#39;mint-ui&#39;: &#39;MINT&#39;,  &#x2F;&#x2F; 需用MINT</span><br><span class="line">      &#39;axios&#39;: &#39;axios&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>index.html加入CDN地址,注意引入的时候要写在body里面，否则会报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;vue&#x2F;2.6.10&#x2F;vue.runtime.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;vue-router&#x2F;3.0.2&#x2F;vue-router.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;vuex&#x2F;3.1.0&#x2F;vuex.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;axios&#x2F;0.18.0&#x2F;axios.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;mint-ui&#x2F;2.2.13&#x2F;index.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>mint-ui样式通过CDN引入。然后商储mian.js文件的 import ‘mint-ui/lib/style.css’ （全局引入模式才有）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;mint-ui&#x2F;2.2.13&#x2F;style.min.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>如果需要引入其他依赖的CDN可以通过<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.bootcdn.cn%2F" target="_blank" rel="noopener">BootCDN查找</a>进行引入。</p>
<p>重新运行项目, 看看效果，已经大大的减小了很多，到了k级别了： </p>
<p><img src="https://upload-images.jianshu.io/upload_images/14483412-e695cda10a61db1f" alt="img"></p>
<p>提取css代码：</p>
<p>因为js会动态的加载出css，所以js文件包会比较大，那么需要提取css代码到文件. 这里我们只需要将css配置一下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  css: &#123;</span><br><span class="line">      extract: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><img src="https://img2018.cnblogs.com/i-beta/1452252/201912/1452252-20191209111148836-1643798091.png" alt="img"></strong></p>
<p><strong>3.图片文件的压缩</strong></p>
<p>图片文件大于在webpack设定的值时，我们可以对其进行压缩在进行引入，安利给大家一个压缩图片的网站<a href="https://links.jianshu.com/go?to=https%3A%2F%2Ftinypng.com%2F" target="_blank" rel="noopener">https://tinypng.com/</a>，它可以批量的压缩图片又不会失真，压缩比相对较大。可以对图片进行有效压缩。</p>
<p><strong>4.gzip的压缩</strong></p>
<p>如果后台有对前端的代码进行gzip压缩的话，那么就不需要进行压缩了，后台自己配置就可以。如果后台不具备这种情况那么我们可以利用compression-webpack-plugin插件可以帮助我们进行gzip压缩：</p>
<p>安装依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev compression-webpack-plugin</span><br></pre></td></tr></table></figure>

<p>然后引入相关代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">const CompressionWebpackPlugin &#x3D; require(&#39;compression-webpack-plugin&#39;)</span><br><span class="line"></span><br><span class="line">const compress &#x3D; new CompressionWebpackPlugin(</span><br><span class="line"> &#123;</span><br><span class="line">   filename: info &#x3D;&gt; &#123;</span><br><span class="line">     return &#96;$&#123;info.path&#125;.gz$&#123;info.query&#125;&#96;</span><br><span class="line">   &#125;,</span><br><span class="line">   algorithm: &#39;gzip&#39;, </span><br><span class="line">   threshold: 10240,</span><br><span class="line">   test: new RegExp(</span><br><span class="line">     &#39;\\.(&#39; +</span><br><span class="line">     [&#39;js&#39;].join(&#39;|&#39;) +</span><br><span class="line">     &#39;)$&#39;</span><br><span class="line">   ),</span><br><span class="line">   minRatio: 0.8,</span><br><span class="line">   deleteOriginalAssets: false</span><br><span class="line"> &#125;</span><br><span class="line">)</span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">devServer: &#123;</span><br><span class="line"></span><br><span class="line">   before(app, server) &#123; </span><br><span class="line">     app.get(&#x2F;.*.(js)$&#x2F;, (req, res, next) &#x3D;&gt; &#123; </span><br><span class="line">       req.url &#x3D; req.url + &#39;.gz&#39;;</span><br><span class="line">       res.set(&#39;Content-Encoding&#39;, &#39;gzip&#39;);</span><br><span class="line">       next();</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> configureWebpack: &#123;</span><br><span class="line">     plugins: [compress]</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>重新run一遍，出现了意向不到的结果了。又原来的2.8M转化为250+kb了，缩小了11倍以上。重大突破</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14483412-e4ceec7b94cf6c7a" alt="img"></p>
<p><strong>6.去除console.log</strong></p>
<p>正常情况下我们会在开发环境进行console调试，但是如果不删除，过多会出现内存泄漏的情况，那么我们可以在正式环境的时候就把它给干掉，实现方法如下：</p>
<p>方法一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const UglifyJsPlugin &#x3D; require(&#39;uglifyjs-webpack-plugin&#39;);</span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    configureWebpack: config &#x3D;&gt; &#123;</span><br><span class="line">        if (IS_PROD) &#123;</span><br><span class="line">            const plugins &#x3D; [];</span><br><span class="line">            plugins.push(</span><br><span class="line">                new UglifyJsPlugin(&#123;</span><br><span class="line">                    uglifyOptions: &#123;</span><br><span class="line">                        compress: &#123;</span><br><span class="line">                            warnings: false,</span><br><span class="line">                            drop_console: true,</span><br><span class="line">                            drop_debugger: false,</span><br><span class="line">                            pure_funcs: [&#39;console.log&#39;]&#x2F;&#x2F;移除console</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    sourceMap: false,</span><br><span class="line">                    parallel: true</span><br><span class="line">                &#125;)</span><br><span class="line">            );</span><br><span class="line">            config.plugins &#x3D; [</span><br><span class="line">                ...config.plugins,</span><br><span class="line">                ...plugins</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法二：使用<code>babel-plugin-transform-remove-console</code>插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev babel-plugin-transform-remove-console</span><br></pre></td></tr></table></figure>

<p>在babel.config.js中配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const plugins &#x3D; [];</span><br><span class="line">if([&#39;production&#39;, &#39;prod&#39;].includes(process.env.NODE_ENV)) &#123;  </span><br><span class="line">  plugins.push(&quot;transform-remove-console&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  presets: [[&quot;@vue&#x2F;app&quot;,&#123;&quot;useBuiltIns&quot;: &quot;entry&quot;&#125;]],</span><br><span class="line">  plugins: plugins</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/19/Vue-%E5%A6%82%E4%BD%95%E5%B0%81%E8%A3%85axios%E5%B9%B6%E4%B8%94%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86api/">Vue-如何封装axios并且统一管理api</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-19</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/Vue/">Vue</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/VUE/">VUE</a></span><div class="content"><ul>
<li><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安装</span></span><br><span class="line">cnpm install  axios </span><br><span class="line">cnpm install vue-axios</span><br></pre></td></tr></table></figure>

<ul>
<li><h4 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h4></li>
</ul>
<p>在main.js中引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"><span class="keyword">import</span> VueAxios <span class="keyword">from</span> <span class="string">'vue-axios'</span></span><br><span class="line">Vue.use(VueAxios, axios);</span><br></pre></td></tr></table></figure>

<p>至此，我们可以在组件中使用axios发送get或者post请求了。但是响应处理以及请求拦截等我们还是需要统一封装的，接下来就需要封装axios。</p>
<ul>
<li><h4 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h4></li>
</ul>
<p>在src目录下面新增request文件夹。然后新增api文件夹，存放我们各个模块的api，新增index.js为各个模块api的统一出口。然后新增http.js封装axios。</p>
<p>目录结构如下<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTgzMzc5LTI2N2Q1NzU3YTBkZmVjOTYuanBn" alt="目录结构"></p>
<p>index.js 内容如下，index.js的功能就是统一导出各模块api,这样我们就不用在main.js中一个个去引入了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * api导出</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> userApi <span class="keyword">from</span> <span class="string">'@/request/api/user'</span>;<span class="comment">//用户管理模块</span></span><br><span class="line"><span class="keyword">import</span> signApi <span class="keyword">from</span> <span class="string">'@/request/api/sign'</span>;<span class="comment">//登录注册模块</span></span><br><span class="line"><span class="keyword">import</span> caseApi <span class="keyword">from</span> <span class="string">'@/request/api/case'</span>;<span class="comment">//病例模块</span></span><br><span class="line"><span class="keyword">import</span> managerApi <span class="keyword">from</span> <span class="string">'@/request/api/manager'</span>;<span class="comment">//管理员模块</span></span><br><span class="line"><span class="keyword">import</span> ringApi <span class="keyword">from</span> <span class="string">'@/request/api/ring'</span>;<span class="comment">//管理员模块</span></span><br><span class="line"><span class="keyword">import</span> structApi <span class="keyword">from</span> <span class="string">'@/request/api/struct'</span>;<span class="comment">//管理员模块</span></span><br><span class="line"><span class="keyword">import</span> scheduleApi <span class="keyword">from</span> <span class="string">'@/request/api/schedule'</span>;<span class="comment">//管理员模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  userApi,</span><br><span class="line">  signApi,</span><br><span class="line">  caseApi,</span><br><span class="line">  managerApi,</span><br><span class="line">  ringApi,</span><br><span class="line">  structApi,</span><br><span class="line">  scheduleApi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以登陆模块为例子，sign.js如下，注意post和get传递参数的区别</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">登录注册模块</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'@/request/http'</span>;</span><br><span class="line"><span class="keyword">import</span> querystring <span class="keyword">from</span> <span class="string">'querystring'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> signApi = &#123;</span><br><span class="line">  <span class="comment">//登录</span></span><br><span class="line">  signin(params)&#123;</span><br><span class="line">    <span class="keyword">return</span> axios.post(<span class="string">'/signin/'</span>,querystring.stringify(params));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//注册</span></span><br><span class="line">  signup(params)&#123;</span><br><span class="line">    <span class="keyword">return</span> axios.post(<span class="string">'/signup/'</span>,querystring.stringify(params));</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//登出</span></span><br><span class="line">  signout(params)&#123;</span><br><span class="line">    <span class="keyword">return</span> axios.get(<span class="string">'/signout/'</span>,&#123;<span class="attr">params</span>: params&#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//获取验证码</span></span><br><span class="line">  getVerifyCodeImg(params)&#123;</span><br><span class="line">    <span class="keyword">return</span> axios.get(<span class="string">'/getVrifyCode'</span>,&#123;<span class="attr">params</span>: params&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> signApi;</span><br></pre></td></tr></table></figure>

<p>http.js内容如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//封装axios</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'../router'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store/index'</span>;</span><br><span class="line"><span class="keyword">import</span> element <span class="keyword">from</span> <span class="string">'element-ui'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vueobj = <span class="keyword">new</span> Vue();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> toSignin = <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">  store.dispatch(<span class="string">"clearUserInfo"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> message = msg ? msg : <span class="string">"session过期，即将前往登录页面"</span>;</span><br><span class="line">  vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: message, <span class="attr">duration</span>: <span class="number">3000</span>, <span class="attr">onClose</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      router.replace(&#123;<span class="attr">path</span>: <span class="string">'/signin'</span>, <span class="attr">query</span>: &#123;<span class="attr">redirect</span>: router.currentRoute.fullPath&#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求失败后的错误统一处理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>status 请求失败的状态码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> errorHandle = <span class="function">(<span class="params">status, other</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 状态码判断</span></span><br><span class="line">  <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">      vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"请求参数有误！"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 401: 未登录状态，跳转登录页</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">      <span class="comment">//vueobj.$message.error(&#123;showClose: true, message: "session过期，即将前往登录页面！", duration: 3000&#125;);</span></span><br><span class="line">      toSignin();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 403 token过期</span></span><br><span class="line">    <span class="comment">// 清除token并跳转登录页</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">      vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"没有操作权限！"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// 404请求不存在</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">      vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"请求不存在"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">      vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"请求失败，服务器内部错误"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">504</span>:</span><br><span class="line">      vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"与服务器连接失败！"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="built_in">console</span>.log(other);</span><br><span class="line">  &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建axios实例</span></span><br><span class="line"><span class="keyword">var</span> instance = axios.create(&#123; <span class="attr">timeout</span>: <span class="number">1000</span> * <span class="number">12</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">instance.interceptors.response.use(</span><br><span class="line">  response =&gt; &#123;</span><br><span class="line">    <span class="comment">// 如果返回的状态码为200，说明接口请求成功，可以正常拿到数据</span></span><br><span class="line">    <span class="comment">// 否则的话抛出错误</span></span><br><span class="line">    <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">typeof</span> response.data != <span class="string">'undefined'</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(response);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 服务器状态码不是2开头的的情况</span></span><br><span class="line">  <span class="comment">// 这里可以跟你们的后台开发人员协商好统一的错误状态码</span></span><br><span class="line">  <span class="comment">// 然后根据返回的状态码进行一些操作，例如登录过期提示，错误提示等等</span></span><br><span class="line">  <span class="comment">// 下面列举几个常见的操作，其他需求可自行扩展</span></span><br><span class="line">  error =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; response &#125; = error;</span><br><span class="line">    <span class="keyword">if</span> (response) &#123;</span><br><span class="line">      <span class="comment">// 请求已发出，但是不在2xx的范围</span></span><br><span class="line">      errorHandle(response.status, response.data.message);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 处理断网的情况</span></span><br><span class="line">      <span class="comment">// eg:请求超时或断网时，更新state的network状态</span></span><br><span class="line">      <span class="comment">// network状态在app.vue中控制着一个全局的断网提示组件的显示隐藏</span></span><br><span class="line">      <span class="comment">// 关于断网组件中的刷新重新获取数据，会在断网组件中说明</span></span><br><span class="line">      <span class="comment">//store.commit('changeNetwork', false);</span></span><br><span class="line">      <span class="comment">//toSignin();</span></span><br><span class="line">      <span class="comment">//vueobj.$message.error(&#123;showClose: true, message: "与服务器连接失败！", duration: 3000&#125;);</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> originalRequest = error.config;</span><br><span class="line">      <span class="keyword">if</span>(error.code == <span class="string">'ECONNABORTED'</span> &amp;&amp; error.message.indexOf(<span class="string">'timeout'</span>)!=<span class="number">-1</span> &amp;&amp; !originalRequest._retry)&#123;</span><br><span class="line">        <span class="comment">// originalRequest._retry = true</span></span><br><span class="line">        <span class="comment">// return axios.request(originalRequest);</span></span><br><span class="line">        vueobj.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">"请求超时，请稍后重试！"</span>, <span class="attr">duration</span>: <span class="number">3000</span>&#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(response);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure>

<p>在main.js中引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'./request/api/index'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将各模块api挂载在vue实例上</span></span><br><span class="line">Vue.prototype.$api = api</span><br></pre></td></tr></table></figure>

<p>至此我们已经将axios成功封装，并且将各个模块的api统一管理，如果后台人员修改了api路径，我们不用去组件中一一修改，只需要在api文件下的模块api作修改。接下来就是使用封装好的api了</p>
<ul>
<li><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4></li>
</ul>
<p>以登陆为例，可通过$api的方式访问我们封装的api了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 登陆</span></span><br><span class="line">  signin: <span class="function"><span class="keyword">function</span> (<span class="params">formName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">    that.$refs[formName].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">        that.loading = <span class="literal">true</span>;</span><br><span class="line">        that.$api.signApi.signin(that.signinForm).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(response.data.code == <span class="string">'201'</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> userinfo = response.data.result;</span><br><span class="line">            userinfo.isSignin = <span class="literal">true</span>;</span><br><span class="line">            that.$store.dispatch(<span class="string">"setUserInfo"</span>, userinfo);</span><br><span class="line"></span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">              <span class="keyword">var</span> redirect = that.$route.query.redirect;</span><br><span class="line">              <span class="keyword">if</span>(redirect)&#123;</span><br><span class="line">                that.$router.push(&#123;<span class="attr">path</span>: redirect&#125;);</span><br><span class="line">              &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>( that.$store.getters.isAdmin) &#123;</span><br><span class="line">                  that.$router.push(&#123;<span class="attr">path</span>: <span class="string">'/manage/user'</span>&#125;);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                  that.$router.push(&#123;<span class="attr">path</span>: <span class="string">'/manage/case'</span>&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              that.loading = <span class="literal">false</span>;</span><br><span class="line">            &#125;,<span class="number">1000</span>);</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            that.loading = <span class="literal">false</span>;</span><br><span class="line">            that.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: response.data.message, <span class="attr">duration</span>: <span class="number">2000</span>&#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">          that.loading = <span class="literal">false</span>;</span><br><span class="line">          that.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: response.data.message, <span class="attr">duration</span>: <span class="number">2000</span>&#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        that.$message.error(&#123;<span class="attr">showClose</span>: <span class="literal">true</span>, <span class="attr">message</span>: that.$t(<span class="string">'promotInfo.inputUnvalid'</span>), <span class="attr">duration</span>: <span class="number">2000</span>&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4></li>
</ul>
<p>本文讲述了如何封装axios并且统一管理各个模块的api，集中管理和统一封装的方式减少了代码的冗余，提高了系统的健壮性，对实际开发中协作开发也有很大帮助。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/12/nodejs%E5%B8%B8%E7%94%A8%E5%8C%85/">nodejs常用包</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-12</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/nodejs/">nodejs</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/nodejs/">nodejs</a></span><div class="content"><h4 id="vue-lazyload"><a href="#vue-lazyload" class="headerlink" title="vue-lazyload"></a>vue-lazyload</h4><p>图片懒加载，功能很全</p>
<h4 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h4><p>支持 promise 的 http 库</p>
<h4 id="amfe-flexible"><a href="#amfe-flexible" class="headerlink" title="amfe-flexible"></a>amfe-flexible</h4><p>移动端适配</p>
<h4 id="vue-meta"><a href="#vue-meta" class="headerlink" title="vue-meta"></a>vue-meta</h4><p>组件中动态修改 head 标签里面的内容</p>
<h4 id="webpack-bundle-analyzer"><a href="#webpack-bundle-analyzer" class="headerlink" title="webpack-bundle-analyzer"></a>webpack-bundle-analyzer</h4><p>打包完成后显示体积相关信息，可以了解是否重复加载,哪些文件过大等</p>
<h4 id="html-webpack-include-assets-plugin"><a href="#html-webpack-include-assets-plugin" class="headerlink" title="html-webpack-include-assets-plugin"></a>html-webpack-include-assets-plugin</h4><p>用于添加 js 或 css 文件路径</p>
<h4 id="vue-awesome-swiper"><a href="#vue-awesome-swiper" class="headerlink" title="vue-awesome-swiper"></a>vue-awesome-swiper</h4><p>移动端轮播图插件</p>
<h4 id="swiper-animate1-0-3-min-js"><a href="#swiper-animate1-0-3-min-js" class="headerlink" title="swiper.animate1.0.3.min.js"></a>swiper.animate1.0.3.min.js</h4><p>动画过渡插件</p>
<h4 id="vue-wechat-title"><a href="#vue-wechat-title" class="headerlink" title="vue-wechat-title"></a>vue-wechat-title</h4><p>微信动态设置标题</p>
<h4 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h4><p>生成 uid(唯一标识符)</p>
<h4 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h4><p>md5 加密</p>
<h4 id="weixin-js-sdk"><a href="#weixin-js-sdk" class="headerlink" title="weixin-js-sdk"></a>weixin-js-sdk</h4><p>微信的 jssdk 库(微信分享)</p>
<h4 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h4><p>用 nodemon 来代替 node 来启动应用</p>
<h4 id="rimraf"><a href="#rimraf" class="headerlink" title="rimraf"></a>rimraf</h4><p>以包的形式包装 rm -rf 命令，用来删除文件和文件夹的，不管文件夹是否为空，都可删除</p>
<h4 id="babel-polyfill"><a href="#babel-polyfill" class="headerlink" title="babel-polyfill"></a>babel-polyfill</h4><p>IE9 不支持 Promise,需安装 babel-polyfill</p>
<h4 id="qs"><a href="#qs" class="headerlink" title="qs"></a>qs</h4><p>数据格式转换插件，配合 axios 使用</p>
<h4 id="fastclick"><a href="#fastclick" class="headerlink" title="fastclick"></a>fastclick</h4><p>移动端项目，点击事件会有 300ms 延迟的问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> FastClick <span class="keyword">from</span> <span class="string">'fastclick'</span> <span class="comment">// 解决移动端300毫秒延迟</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">'addEventListener'</span> <span class="keyword">in</span> <span class="built_in">document</span>) &#123;</span><br><span class="line">  <span class="built_in">document</span>.addEventListener(</span><br><span class="line">    <span class="string">'DOMContentLoaded'</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      FastClick.attach(<span class="built_in">document</span>.body)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="fs-extra"><a href="#fs-extra" class="headerlink" title="fs-extra"></a>fs-extra</h4><p>fs-extra 是 fs 的一个扩展</p>
<h4 id="vue-contextmenu"><a href="#vue-contextmenu" class="headerlink" title="vue-contextmenu"></a>vue-contextmenu</h4><p>右键弹出菜单插件</p>
<h4 id="vue-touch"><a href="#vue-touch" class="headerlink" title="vue-touch"></a>vue-touch</h4><p>装了 hammer.js 的方法</p>
<h4 id="vuex-persistedstate"><a href="#vuex-persistedstate" class="headerlink" title="vuex-persistedstate"></a>vuex-persistedstate</h4><p>vuex 数据持久化</p>
<h4 id="es6-promise"><a href="#es6-promise" class="headerlink" title="es6-promise"></a>es6-promise</h4><p>require(‘es6-promise’).polyfill()</p>
<h4 id="vconsole"><a href="#vconsole" class="headerlink" title="vconsole"></a>vconsole</h4><p>手机端调试 console</p>
<h4 id="script-loader"><a href="#script-loader" class="headerlink" title="script-loader"></a>script-loader</h4><p>在全局上下文执行了一次 file.js 文档</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.exec\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'script-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> exec <span class="keyword">from</span> <span class="string">'script-loader!./script.js'</span></span><br></pre></td></tr></table></figure>

<h4 id="animate-css"><a href="#animate-css" class="headerlink" title="animate.css"></a>animate.css</h4><p>css 动画库</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// main.js import animate from 'animate.css' Vue.use(animate)</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">enter-active-class</span>=<span class="string">"animated zoomInLeft"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">leave-active-class</span>=<span class="string">"animated zoomOutRight"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="vue-pano"><a href="#vue-pano" class="headerlink" title="vue-pano"></a>vue-pano</h4><p>全景图插件</p>
<h4 id="better-scroll"><a href="#better-scroll" class="headerlink" title="better-scroll"></a>better-scroll</h4><p>滚动插件</p>
<h4 id="vue-amap"><a href="#vue-amap" class="headerlink" title="vue-amap"></a>vue-amap</h4><p>高德地图</p>
<h4 id="vue-ba"><a href="#vue-ba" class="headerlink" title="vue-ba"></a>vue-ba</h4><p>百度统计</p>
<h4 id="vue-kindedtior"><a href="#vue-kindedtior" class="headerlink" title="vue-kindedtior"></a>vue-kindedtior</h4><p>富文本编辑器</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/11/22/setInterval%E4%B8%8EsetTimeout%E7%9A%84%E5%8C%BA%E5%88%AB/">setInterval与setTimeout的区别</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-22</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/JS/">JS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JS/">JS</a></span><div class="content"><p>在制作网页动态效果时，一定会遇到某些需求，要求某段程序等待多时时间后再开始执行，就像在我们的生活中一样，待会儿再开始做一件事。在JavaScript中主要通过定时器实现此类需求，本文将对定时器做一个概括，正对setTimeout()做一个详细用法总结。</p>
<h2 id="一-setInterval与setTimeout的区别"><a href="#一-setInterval与setTimeout的区别" class="headerlink" title="一.setInterval与setTimeout的区别"></a>一.setInterval与setTimeout的区别</h2><p><strong>setInterval</strong></p>
<p>setInterval()方法可按照指定的周期来调用函数或者计算表达式（以毫秒为单位）</p>
<p><strong>语法：</strong></p>
<p>setInterval(函数表达式，毫秒数)；</p>
<p>setInterval()会不停的调用函数，直到clearInterval()被调用或者窗口被关闭，由 setInterval()返回的ID值可用作clearInterval()方法的参数。</p>
<p><strong>setTimeout</strong></p>
<p>setTimeout()方法用于在指定毫秒数后再调用函数或者计算表达式（以毫秒为单位）</p>
<p><strong>语法：</strong></p>
<p>setTimeout(函数表达式，毫秒数)；</p>
<p>setTimeout()只执行函数一次，如果需要多次调用可以使用setInterval(),或者在函数体内再次调用setTimeout()</p>
<p><strong>区别</strong></p>
<p>　　通过以上分析可以看出，setTimeout与setInterval的主要区别是:</p>
<p>　　setTimeout()方法只运行一次，也就是说当达到设定的时间后就出发运行指定的代码，运行完后就结束了，如果还想再次执行同样的函数，可以在函数体内再次调用setTimeout()，可以达到循环调用的效果。</p>
<p>　　setInterval()是循环执行的，即每达到指定的时间间隔就执行相应的函数或者表达式，是真正的定时器。</p>
<h2 id="二-setTimeout-的用法"><a href="#二-setTimeout-的用法" class="headerlink" title="二.setTimeout()的用法"></a>二.setTimeout()的用法</h2><p>　　先写个最简单的demo，如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> 1 <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> 2  <span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"> 3      <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> 4            <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"> 5            <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"> <span class="number">6</span>                   setTimeout(<span class="string">"alert('hello')"</span>,<span class="number">2000</span>);</span></span><br><span class="line"> 7            <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> 8      <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> 9     <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">10     <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">11 <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<p>页面会在停留2秒之后弹出对话框,注意setTimeout不会自动重复执行！</p>
<p>当然，setTimeout也可以执行function，还可以不断重复执行！</p>
<p>你可以看到h1中的文本数字在一秒一秒地递增！</p>
<p>更加灵活的是，你还可以指定重复执行的次数，如下：</p>
<p>if判断中的数字，是用来限制重复执行次数的条件。</p>
<h2 id="三-clearTimeout"><a href="#三-clearTimeout" class="headerlink" title="三.clearTimeout()"></a>三.clearTimeout()</h2><p>要使用clearTimeout()，需要我们设定setTimeout()时， 给予这setTimeout()一个名称, 这名称就是timeoutID ，我们叫停时，就是用这 timeoutID 来叫停</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> 1  <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> 2   <span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"> 3       <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> 4             <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"> 5             <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"> <span class="number">6</span>                   <span class="keyword">var</span> timeId= setTimeout(<span class="string">"alert('hello')"</span>,<span class="number">2000</span>);</span></span><br><span class="line"> 7                    clearTimeout(timeId);</span><br><span class="line"> 8             <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> 9       <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">10      <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">11      <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">12  <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>原计划1秒后弹出的警示框，被自然叫停了。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/11/16/%E5%BC%80%E5%8F%91%E3%80%81%E6%B5%8B%E8%AF%95%E3%80%81%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E7%81%B5%E6%B4%BB%E9%85%8D%E7%BD%AE/">开发测试环境的灵活配置</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-16</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/vue/">vue</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/vue/">vue</a></span><div class="content"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BASE_URL_DEV = <span class="string">'http://192.168.0.63:8080/sfFinace/'</span></span><br><span class="line"><span class="keyword">const</span> BASE_URL_TEST = <span class="string">'http://192.168.0.63:8080/sfFinace/'</span></span><br><span class="line"><span class="keyword">const</span> BASE_URL_PRO = <span class="string">'http://192.168.0.63:8080/sfFinace/'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MODE_TYPE = &#123;</span><br><span class="line">  DEV : <span class="number">0</span>,</span><br><span class="line">  TEST: <span class="number">1</span>,</span><br><span class="line">  PRO: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MODE = MODE_TYPE.DEV</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> BASE_URL = [BASE_URL_DEV, BASE_URL_TEST, BASE_URL_PRO][MODE]</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/10/22/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%BD%AC%E6%8D%A2/">数据结构转换.js</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-22</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/">web前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/web%E5%89%8D%E7%AB%AF/JS/">JS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JS/">JS</a></span><div class="content"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">join()</span><br><span class="line">push()和pop()</span><br><span class="line">shift() 和 unshift()</span><br><span class="line">sort()</span><br><span class="line">reverse()</span><br><span class="line">concat()</span><br><span class="line">slice()</span><br><span class="line">splice()</span><br><span class="line">indexOf()和 lastIndexOf() （ES5新增）</span><br><span class="line">forEach() （ES5新增）</span><br><span class="line">map() （ES5新增）</span><br><span class="line">filter() （ES5新增）</span><br><span class="line">every() （ES5新增）</span><br><span class="line">some() （ES5新增）</span><br><span class="line"></span><br><span class="line"><span class="comment">//join，就是把数组转换成字符串，然后给他规定个连接字符，默认的是逗号(  ，)</span></span><br><span class="line"><span class="comment">//书写格式：join(" ")，括号里面写字符串  ("要加引号"),</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.join()); 　　　　<span class="comment">// 1,2,3</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.join(<span class="string">"-"</span>)); 　　<span class="comment">// 1-2-3</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　<span class="comment">// [1, 2, 3]（原数组不变）</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//push():  把里面的内容添加到数组末尾，并返回修改后的长度。</span></span><br><span class="line"><span class="comment">//书写格式：arr.push(" ")，括号里面写内容  ("字符串要加引号"),</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//pop()：移除数组最后一项，返回移除的那个值，减少数组的length。</span></span><br><span class="line"><span class="comment">//书写格式：arr.pop( )</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">"Lily"</span>,<span class="string">"lucy"</span>,<span class="string">"Tom"</span>];</span><br><span class="line"><span class="keyword">var</span> count = arr.push(<span class="string">"Jack"</span>,<span class="string">"Sean"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(count); 　　　　　　　　　　<span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　<span class="comment">// ["Lily", "lucy", "Tom", "Jack", "Sean"]</span></span><br><span class="line"><span class="keyword">var</span> item = arr.pop();</span><br><span class="line"><span class="built_in">console</span>.log(item); 　　　　　　　　　　 <span class="comment">// Sean</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　  <span class="comment">// ["Lily", "lucy", "Tom", "Jack"]</span></span><br><span class="line">shift()：删除原数组第一项，并返回删除元素的值；如果数组为空则返回<span class="literal">undefined</span> 。 </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">unshift:将参数添加到原数组开头，并返回数组的长度 。</span><br><span class="line">书写格式：arr.shift(<span class="string">" "</span>)，括号里面写内容  (<span class="string">"字符串要加引号"</span>),</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">"Lily"</span>,<span class="string">"lucy"</span>,<span class="string">"Tom"</span>];</span><br><span class="line"><span class="keyword">var</span> count = arr.unshift(<span class="string">"Jack"</span>,<span class="string">"Sean"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(count); 　　　　　　　　　　　　　　<span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　　<span class="comment">//["Jack", "Sean", "Lily", "lucy", "Tom"]</span></span><br><span class="line"><span class="keyword">var</span> item = arr.shift();</span><br><span class="line"><span class="built_in">console</span>.log(item); 　　　　　　　　　　　　　　<span class="comment">// Jack</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　 <span class="comment">// ["Sean", "Lily", "lucy", "Tom"]</span></span><br><span class="line">sort()：将数组里的项从小到大排序</span><br><span class="line">书写格式：arr.sort( )</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"c"</span>, <span class="string">"b"</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr1.sort()); 　　　　　　　　　　<span class="comment">// ["a", "b", "c", "d"]</span></span><br><span class="line">sort()方法比较的是字符串，没有按照数值的大小对数字进行排序，要实现这一点，就必须使用一个排序函数</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortNumber</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">　　<span class="keyword">return</span> a - b</span><br><span class="line">&#125;</span><br><span class="line">arr = [<span class="number">13</span>, <span class="number">24</span>, <span class="number">51</span>, <span class="number">3</span>]; <span class="built_in">console</span>.log(arr.sort()); 　　　　　　　　　　<span class="comment">// [13, 24, 3, 51] </span></span><br><span class="line"><span class="built_in">console</span>.log(arr.sort(sortNumber)); 　　　　<span class="comment">// [3, 13, 24, 51](数组被改变)</span></span><br><span class="line">reverse()：反转数组项的顺序。</span><br><span class="line"></span><br><span class="line">　　　   书写格式：arr.reverse( )</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">13</span>, <span class="number">24</span>, <span class="number">51</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.reverse()); 　　　　　　　　<span class="comment">//[3, 51, 24, 13]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　<span class="comment">//[3, 51, 24, 13](原数组改变)</span></span><br><span class="line">concat() ：将参数添加到原数组中。这个方法会先创建当前数组一个副本，然后将接收到的参数添加到这个副本的末尾，最后返回新构建的数组。在没有给 concat()方法传递参数的情况下，它只是复制当前数组并返回副本。</span><br><span class="line"></span><br><span class="line">　　　　书写格式：arr.concat()，括号里面写内容  (<span class="string">"字符串要加引号"</span>),</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> arrCopy = arr.concat(<span class="number">9</span>,[<span class="number">11</span>,<span class="number">13</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(arrCopy); 　　　　　　　　　　　　<span class="comment">//[1, 3, 5, 7, 9, 11, 13]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　<span class="comment">// [1, 3, 5, 7](原数组未被修改)</span></span><br><span class="line">slice()：返回从原数组中指定开始下标到结束下标之间的项组成的新数组。slice()方法可以接受一或两个参数，即要返回项的起始和结束位置。在只有一个参数的情况下， slice()方法返回从该参数指定位置开始到当前数组末尾的所有项。如果有两个参数，该方法返回起始和结束位置之间的项——但不包括结束位置的项。</span><br><span class="line"></span><br><span class="line">　　　　书写格式：arr.slice( <span class="number">1</span> , <span class="number">3</span>  )</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>];</span><br><span class="line"><span class="keyword">var</span> arrCopy = arr.slice(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> arrCopy2 = arr.slice(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">var</span> arrCopy3 = arr.slice(<span class="number">1</span>,<span class="number">-2</span>);</span><br><span class="line"><span class="keyword">var</span> arrCopy4 = arr.slice(<span class="number">-4</span>,<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　<span class="comment">//[1, 3, 5, 7, 9, 11](原数组没变)</span></span><br><span class="line"><span class="built_in">console</span>.log(arrCopy); 　　　　　　　　　　　 <span class="comment">//[3, 5, 7, 9, 11]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrCopy2); 　　　　　　　　　　　<span class="comment">//[3, 5, 7]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrCopy3); 　　　　　　　　　　　<span class="comment">//[3, 5, 7]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrCopy4); 　　　　　　　　　　　<span class="comment">//[5, 7, 9]</span></span><br><span class="line">　　arrCopy只设置了一个参数，也就是起始下标为<span class="number">1</span>，所以返回的数组为下标<span class="number">1</span>（包括下标<span class="number">1</span>）开始到数组最后。 </span><br><span class="line"></span><br><span class="line">　　arrCopy2设置了两个参数，返回起始下标（包括<span class="number">1</span>）开始到终止下标（不包括<span class="number">4</span>）的子数组。 </span><br><span class="line"></span><br><span class="line">　　arrCopy3设置了两个参数，终止下标为负数，当出现负数时，将负数加上数组长度的值（<span class="number">6</span>）来替换该位置的数，因此就是从<span class="number">1</span>开始到<span class="number">4</span>（不包括）的子数组。 </span><br><span class="line"></span><br><span class="line">　　arrCopy4中两个参数都是负数，所以都加上数组长度<span class="number">6</span>转换成正数，因此相当于slice(<span class="number">2</span>,<span class="number">5</span>)。</span><br><span class="line"></span><br><span class="line">splice()：删除、插入和替换。</span><br><span class="line"></span><br><span class="line">删除：指定 <span class="number">2</span> 个参数：要删除的第一项的位置和要删除的项数。</span><br><span class="line"></span><br><span class="line"><span class="comment">//书写格式：arr.splice( 1 , 3  )</span></span><br><span class="line"><span class="comment">//插入：可以向指定位置插入任意数量的项，只需提供 3 个参数：起始位置、 0（要删除的项数）和要插入的项。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//书写格式：arr.splice(  2,0,4,6  )</span></span><br><span class="line"><span class="comment">//替换：可以向指定位置插入任意数量的项，且同时删除任意数量的项，只需指定 3 个参数：起始位置、要删除的项数和要插入的任意数量的项。插入的项数不必与删除的项数相等。</span></span><br><span class="line"><span class="comment">//书写格式：arr.splice(  2,0,4,6  )</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">11</span>];</span><br><span class="line"><span class="keyword">var</span> arrRemoved = arr.splice(<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　　<span class="comment">//[5, 7, 9, 11]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrRemoved); 　　　　　　　　　　　<span class="comment">//[1, 3]</span></span><br><span class="line"><span class="keyword">var</span> arrRemoved2 = arr.splice(<span class="number">2</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">6</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　　<span class="comment">// [5, 7, 4, 6, 9, 11]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrRemoved2); 　　　　　　　　　　<span class="comment">// []</span></span><br><span class="line"><span class="keyword">var</span> arrRemoved3 = arr.splice(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr); 　　　　　　　　　　　　　　　<span class="comment">// [5, 2, 4, 4, 6, 9, 11]</span></span><br><span class="line"><span class="built_in">console</span>.log(arrRemoved3); 　　　　　　　　　　<span class="comment">//[7]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//indexOf()：接收两个参数：要查找的项和（可选的）表示查找起点位置的索引。其中， 从数组的开头（位置 0）开始向后查找。</span></span><br><span class="line"><span class="comment">//书写格式：arr.indexof( 5 )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//lastIndexOf：接收两个参数：要查找的项和（可选的）表示查找起点位置的索引。其中， 从数组的末尾开始向前查找。 </span></span><br><span class="line"><span class="comment">//书写格式：arr.lastIndexOf(  5,4  )</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">1</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="number">5</span>)); 　　　　　　<span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.lastIndexOf(<span class="number">5</span>)); 　　　 <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="number">5</span>,<span class="number">2</span>)); 　　　　 <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.lastIndexOf(<span class="number">5</span>,<span class="number">4</span>)); 　　<span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="string">"5"</span>)); 　　　　 <span class="comment">//-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//forEach()：对数组进行遍历循环，对数组中的每一项运行给定函数。这个方法没有返回值。参数都是function类型，默认有传参，参数分别为：遍历的数组内容；第对应的数组索引，数组本身。</span></span><br><span class="line"><span class="comment">//书写格式：arr.forEach()</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">x, index, a</span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(x + <span class="string">'|'</span> + index + <span class="string">'|'</span> + (a === arr));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 输出为：</span></span><br><span class="line"><span class="comment">// 1|0|true</span></span><br><span class="line"><span class="comment">// 2|1|true</span></span><br><span class="line"><span class="comment">// 3|2|true</span></span><br><span class="line"><span class="comment">// 4|3|true</span></span><br><span class="line"><span class="comment">// 5|4|true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//map()：指“映射”，对数组中的每一项运行给定函数，返回每次函数调用的结果组成的数组。</span></span><br><span class="line"><span class="comment">//书写格式：arr.map()</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> item*item;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(arr2); 　　　　　　　　<span class="comment">//[1, 4, 9, 16, 25]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//filter()：“过滤”功能，数组中的每一项运行给定函数，返回满足过滤条件组成的数组。</span></span><br><span class="line"><span class="comment">//书写格式：arr.filter()</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">x, index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> index % <span class="number">3</span> === <span class="number">0</span> || x &gt;= <span class="number">8</span>;</span><br><span class="line">&#125;); </span><br><span class="line"><span class="built_in">console</span>.log(arr2); 　　　　　　　　<span class="comment">//[1, 4, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//every()：判断数组中每一项都是否满足条件，只有所有项都满足条件，才会返回true。</span></span><br><span class="line"><span class="comment">//书写格式：arr.every()</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &lt; <span class="number">10</span>;</span><br><span class="line">&#125;); </span><br><span class="line"><span class="built_in">console</span>.log(arr2); 　　　　　　　　<span class="comment">//true</span></span><br><span class="line"><span class="keyword">var</span> arr3 = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &lt; <span class="number">3</span>;</span><br><span class="line">&#125;); </span><br><span class="line"><span class="built_in">console</span>.log(arr3); 　　　　　　　　<span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//some()：判断数组中是否存在满足条件的项，只要有一项满足条件，就会返回true。</span></span><br><span class="line"><span class="comment">//书写格式：arr.some()</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &lt; <span class="number">3</span>;</span><br><span class="line">&#125;); </span><br><span class="line"><span class="built_in">console</span>.log(arr2); 　　　　　　　　<span class="comment">//true</span></span><br><span class="line"><span class="keyword">var</span> arr3 = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x &lt; <span class="number">1</span>;</span><br><span class="line">&#125;); </span><br><span class="line"><span class="built_in">console</span>.log(arr3); 　　　　　　　　<span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> protypeidList = []</span><br><span class="line"><span class="comment">//将this.addForm.ptlist数组中的元素最后一个值取到，追加到新的数组protypeidList中</span></span><br><span class="line"><span class="keyword">this</span>.addForm.ptlist.forEach(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">let</span> id = r[r.length - <span class="number">1</span>]</span><br><span class="line">	protypeidList.push(id)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//将ptlist数组遍历后取到值，再为每个值添加属性名后追到新的数组中</span></span><br><span class="line"><span class="keyword">let</span> ptlist = []</span><br><span class="line">protypeidList.map(<span class="function"><span class="params">v</span> =&gt;</span> ptlist.push(&#123;</span><br><span class="line">	protypeid: v</span><br><span class="line">&#125;))</span><br><span class="line"><span class="built_in">console</span>.log(ptlist);</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By liweipeng</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>